"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["981"],{70731:function(e,t,s){s.a(e,async function(e,n){try{s.r(t);var r,a,i,o,c,u,h=s(29694),d=s(75778),l=s(54982),p=s(54521),f=s(4490),v=s(20129),g=s(85297),_=s(53389),m=(s(12212),s(39710),s(26847),s(54480),s(1455),s(48694),s(27530),s(73742)),b=s(59048),y=s(7616),k=s(39884),w=s(67050),Z=s(64637),x=s(65863),T=(s(81777),s(81276)),z=s(31021),S=s(21534),C=s(72242),D=s(41906),A=(s(51869),e([D]));D=(A.then?(await A)():A)[0];var M=function(e){function t(){var e;(0,p.Z)(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=(0,v.Z)(this,t,[].concat(n))).ingressPanel=!1,e.narrow=!1,e}return(0,g.Z)(t,e),(0,f.Z)(t,[{key:"disconnectedCallback",value:function(){(0,_.Z)(t,"disconnectedCallback",this,3)([]),this._sessionKeepAlive&&(clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=void 0),this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0)}},{key:"render",value:function(){if(!this._addon)return(0,b.dy)(r||(r=(0,l.Z)(['<hass-loading-screen .message="','"></hass-loading-screen>'])),this._loadingMessage);var e=(0,b.dy)(a||(a=(0,l.Z)(['<iframe title="','" src="','" @load="','"> </iframe>'])),this._addon.name,this._addon.ingress_url,this._checkLoaded);return this.ingressPanel?(0,b.dy)(o||(o=(0,l.Z)(["",""])),this.narrow||"always_hidden"===this.hass.dockedSidebar?(0,b.dy)(c||(c=(0,l.Z)(['<div class="header"> <ha-icon-button .label="','" .path="','" @click="','"></ha-icon-button> <div class="main-title">',"</div> </div> ",""])),this.hass.localize("ui.sidebar.sidebar_toggle"),"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z",this._toggleMenu,this._addon.name,e):e):(0,b.dy)(i||(i=(0,l.Z)(['<hass-subpage .hass="','" .header="','" .narrow="','"> '," </hass-subpage>"])),this.hass,this._addon.name,this.narrow,e)}},{key:"firstUpdated",value:(u=(0,d.Z)((0,h.Z)().m(function e(){var t,s,n;return(0,h.Z)().w(function(e){for(;;)switch(e.n){case 0:if(""!==this.route.path){e.n=13;break}if(!(t=(0,Z.io)("addon"))){e.n=13;break}return e.p=1,e.n=2,(0,T.AD)(this.hass,t);case 2:s=e.v,e.n=6;break;case 3:return e.p=3,n=e.v,e.n=4,(0,C.Ys)(this,{text:(0,z.js)(n),title:t});case 4:return e.n=5,(0,x.y)();case 5:return(0,w.c)("/hassio/store",{replace:!0}),e.a(2);case 6:if(s.version){e.n=9;break}return e.n=7,(0,C.Ys)(this,{text:this.supervisor.localize("my.error_addon_not_installed"),title:s.name});case 7:return e.n=8,(0,x.y)();case 8:(0,w.c)("/hassio/addon/".concat(s.slug,"/info"),{replace:!0}),e.n=13;break;case 9:if(s.ingress){e.n=12;break}return e.n=10,(0,C.Ys)(this,{text:this.supervisor.localize("my.error_addon_no_ingress"),title:s.name});case 10:return e.n=11,(0,x.y)();case 11:(0,w.c)("/hassio/addon/".concat(s.slug,"/info"),{replace:!0}),e.n=13;break;case 12:(0,w.c)("/hassio/ingress/".concat(s.slug),{replace:!0});case 13:return e.a(2)}},e,this,[[1,3]])})),function(){return u.apply(this,arguments)})},{key:"willUpdate",value:function(e){if((0,_.Z)(t,"willUpdate",this,3)([e]),e.has("route")){var s=this.route.path.substring(1),n=e.get("route"),r=n?n.path.substring(1):void 0;s&&s!==r&&(this._loadingMessage=void 0,this._fetchData(s))}}},{key:"_fetchData",value:(n=(0,d.Z)((0,h.Z)().m(function e(t){var s,n,r,a=this;return(0,h.Z)().w(function(e){for(;;)switch(e.n){case 0:return s=(0,S.U)(this.hass),e.p=1,e.n=2,(0,T.AD)(this.hass,t);case 2:n=e.v,e.n=7;break;case 3:return e.p=3,e.v,e.n=4,this.updateComplete;case 4:return e.n=5,(0,C.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_info")||"Unable to fetch add-on info to start Ingress",title:"Supervisor"});case 5:return e.n=6,(0,x.y)();case 6:return(0,w.c)("/hassio/store",{replace:!0}),e.a(2);case 7:if(n.version){e.n=11;break}return e.n=8,this.updateComplete;case 8:return e.n=9,(0,C.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_not_installed")||"The add-on is not installed. Please install it first",title:n.name});case 9:return e.n=10,(0,x.y)();case 10:return(0,w.c)("/hassio/addon/".concat(n.slug,"/info"),{replace:!0}),e.a(2);case 11:if(n.ingress_url){e.n=15;break}return e.n=12,this.updateComplete;case 12:return e.n=13,(0,C.Ys)(this,{text:this.supervisor.localize("ingress.error_addon_not_supported")||"This add-on does not support Ingress",title:n.name});case 13:return e.n=14,(0,x.y)();case 14:return history.back(),e.a(2);case 15:if(n.state&&["startup","started"].includes(n.state)){e.n=25;break}return e.n=16,this.updateComplete;case 16:return e.n=17,(0,C.g7)(this,{text:this.supervisor.localize("ingress.error_addon_not_running")||"The add-on is not running. Do you want to start it now?",title:n.name,confirmText:this.supervisor.localize("ingress.start_addon")||"Start add-on",dismissText:this.supervisor.localize("common.no")||"No"});case 17:if(!e.v){e.n=23;break}return e.p=18,this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",e.n=19,(0,T.kP)(this.hass,t);case 19:return(0,k.B)(this,"supervisor-collection-refresh",{collection:"addon"}),this._fetchData(t),e.a(2);case 20:return e.p=20,e.v,e.n=21,(0,C.Ys)(this,{text:this.supervisor.localize("ingress.error_starting_addon")||"Error starting the add-on",title:n.name});case 21:return e.n=22,(0,x.y)();case 22:return(0,w.c)("/hassio/addon/".concat(n.slug,"/logs"),{replace:!0}),e.a(2);case 23:return e.n=24,(0,x.y)();case 24:return(0,w.c)("/hassio/addon/".concat(n.slug,"/info"),{replace:!0}),e.a(2);case 25:if("startup"!==n.state){e.n=26;break}return this._loadingMessage=this.supervisor.localize("ingress.addon_starting")||"The add-on is starting, this can take some time...",this._fetchDataTimeout=window.setTimeout(function(){a._fetchData(t)},500),e.a(2);case 26:if("started"===n.state){e.n=27;break}return e.a(2);case 27:return this._loadingMessage=void 0,this._fetchDataTimeout&&(clearInterval(this._fetchDataTimeout),this._fetchDataTimeout=void 0),e.p=28,e.n=29,s;case 29:r=e.v,e.n=33;break;case 30:return e.p=30,e.v,this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),e.n=31,(0,C.Ys)(this,{text:this.supervisor.localize("ingress.error_creating_session")||"Unable to create an Ingress session",title:n.name});case 31:return e.n=32,(0,x.y)();case 32:return history.back(),e.a(2);case 33:this._sessionKeepAlive&&clearInterval(this._sessionKeepAlive),this._sessionKeepAlive=window.setInterval((0,d.Z)((0,h.Z)().m(function e(){return(0,h.Z)().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,S.n)(a.hass,r);case 1:e.n=4;break;case 2:return e.p=2,e.v,e.n=3,(0,S.U)(a.hass);case 3:r=e.v;case 4:return e.a(2)}},e,null,[[0,2]])})),6e4),this._addon=n;case 34:return e.a(2)}},e,this,[[28,30],[18,20],[1,3]])})),function(e){return n.apply(this,arguments)})},{key:"_checkLoaded",value:(s=(0,d.Z)((0,h.Z)().m(function e(t){var s=this;return(0,h.Z)().w(function(e){for(;;)switch(e.n){case 0:if(this._addon){e.n=1;break}return e.a(2);case 1:if("502: Bad Gateway"!==t.target.contentDocument.body.textContent){e.n=3;break}return e.n=2,this.updateComplete;case 2:(0,C.g7)(this,{text:this.supervisor.localize("ingress.error_addon_not_ready")||"The add-on seems to not be ready, it might still be starting. Do you want to try again?",title:this._addon.name,confirmText:this.supervisor.localize("ingress.retry")||"Retry",dismissText:this.supervisor.localize("common.no")||"No",confirm:function(){var e=(0,d.Z)((0,h.Z)().m(function e(){var t;return(0,h.Z)().w(function(e){for(;;)switch(e.n){case 0:return t=s._addon,s._addon=void 0,e.n=1,Promise.all([s.updateComplete,new Promise(function(e){setTimeout(e,500)})]);case 1:s._addon=t;case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}()});case 3:return e.a(2)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_toggleMenu",value:function(){(0,k.B)(this,"hass-toggle-menu")}}]);var s,n,u}(b.oi);M.styles=(0,b.iv)(u||(u=(0,l.Z)(["iframe{display:block;width:100%;height:100%;border:0}.header+iframe{height:calc(100% - 40px)}.header{display:flex;align-items:center;font-size:var(--ha-font-size-l);height:40px;padding:0 16px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box;--mdc-icon-size:20px}.main-title{margin:var(--margin-title);line-height:var(--ha-line-height-condensed);flex-grow:1}ha-icon-button{pointer-events:auto}hass-subpage{--app-header-background-color:var(--sidebar-background-color);--app-header-text-color:var(--sidebar-text-color);--app-header-border-bottom:1px solid var(--divider-color)}"]))),(0,m.__decorate)([(0,y.Cb)({attribute:!1})],M.prototype,"hass",void 0),(0,m.__decorate)([(0,y.Cb)({attribute:!1})],M.prototype,"supervisor",void 0),(0,m.__decorate)([(0,y.Cb)({attribute:!1})],M.prototype,"route",void 0),(0,m.__decorate)([(0,y.Cb)({attribute:!1})],M.prototype,"ingressPanel",void 0),(0,m.__decorate)([(0,y.Cb)({type:Boolean})],M.prototype,"narrow",void 0),(0,m.__decorate)([(0,y.SB)()],M.prototype,"_addon",void 0),(0,m.__decorate)([(0,y.SB)()],M.prototype,"_loadingMessage",void 0),M=(0,m.__decorate)([(0,y.Mo)("hassio-ingress-view")],M),n()}catch(P){n(P)}})},64637:function(e,t,s){s.d(t,{Q2:function(){return i},io:function(){return o},ou:function(){return c}});var n=s(10354),r=s(75706),a=(s(26847),s(81738),s(22960),s(48454),s(54480),s(64455),s(56303),s(48694),s(41381),s(67398),s(27530),s(95729),s(36330),s(38221),s(75863),s(88479)),i=function(){var e,t={},s=new URLSearchParams(a.E.location.search),i=(0,r.Z)(s.entries());try{for(i.s();!(e=i.n()).done;){var o=(0,n.Z)(e.value,2),c=o[0],u=o[1];t[c]=u}}catch(h){i.e(h)}finally{i.f()}return t},o=function(e){return new URLSearchParams(a.E.location.search).get(e)},c=function(e){var t=new URLSearchParams;return Object.entries(e).forEach(function(e){var s=(0,n.Z)(e,2),r=s[0],a=s[1];t.append(r,a)}),t.toString()}},21534:function(e,t,s){s.d(t,{U:function(){return o},n:function(){return c}});var n=s(29694),r=s(75778),a=(s(12212),s(43893));function i(e){return document.cookie="ingress_session=".concat(e,";path=/api/hassio_ingress/;SameSite=Strict").concat("https:"===location.protocol?";Secure":""),e}var o=function(){var e=(0,r.Z)((0,n.Z)().m(function e(t){var s,r;return(0,n.Z)().w(function(e){for(;;)switch(e.n){case 0:if(!(0,a.I)(t.config.version,2021,2,4)){e.n=2;break}return e.n=1,t.callWS({type:"supervisor/api",endpoint:"/ingress/session",method:"post"});case 1:return s=e.v,e.a(2,i(s.session));case 2:return e.n=3,t.callApi("POST","hassio/ingress/session");case 3:return r=e.v,e.a(2,i(r.data.session))}},e)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,r.Z)((0,n.Z)().m(function e(t,s){return(0,n.Z)().w(function(e){for(;;)switch(e.n){case 0:if(!(0,a.I)(t.config.version,2021,2,4)){e.n=2;break}return e.n=1,t.callWS({type:"supervisor/api",endpoint:"/ingress/validate_session",method:"post",data:{session:s}});case 1:case 3:return e.a(2);case 2:return e.n=3,t.callApi("POST","hassio/ingress/validate_session",{session:s})}},e)}));return function(t,s){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=981.372b139b6022ff14.js.map